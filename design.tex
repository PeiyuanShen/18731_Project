\section{Design}% 1-2pg}
% What are plausible alternatives you considered?

% provide block diagrams of how the system works, what are the interfaces between
% components

% what are the key ideas and technical challenges

% how did you implement/prototype said ideas
\begin{figure}[tbp]
  \begin{tikzpicture}

    \node [draw,
      minimum width=2cm,
      minimum height=1.2cm,
    ]  (app) {Spring Web Applications};

    \node [draw,
      minimum width=2cm,
      minimum height=1.2cm,
      right=1.5cm of app,
    ]  (doop) {Doop};

    \node [draw,
      minimum width=2cm,
      minimum height=1.2cm,
      below=1cm of app,
    ]  (syn) {Policy Synthesizer};

    \node [draw,
      minimum width=2cm,
      minimum height=1.2cm,
      right=1.2cm of syn,
    ]  (detect) {Detect Vulnerabilities};

    \draw[-stealth] (app.east) -- (doop.west)
    node[midway,above]{*.jar file};

    \draw[-stealth] (app.south) -- (syn.north)
    node[midway,right]{API codes};

    \draw[-stealth] (doop.south) -- (syn.north)
    node[midway,right]{CallGraphEdge.csv};

    \draw[-stealth] (syn.east) -- (detect.west)
    node[midway,above]{Policies};

  \end{tikzpicture}
  \caption{System block diagram.}
  \label{fig:desgin}
\end{figure}

\subsection{Overview}
Sicheng


\subsection{Policy Synthesizer}

\subsubsection{Identify security-sensitive events}
Sicheng. TODO: also add code
\subsubsection{Construct calling-context topology}

\subsubsection{Generate security policies}

\begin{figure} [btp]
  \small
  \begin{tabular}{rcp{5cm}}
    Policy \hspace*{-3ex}    & $\rightarrow$ & \hspace*{-3ex} Statement$*$                                                      \\
    Statement \hspace*{-3ex} & $\rightarrow$ & \hspace*{-3ex} (Principal, Action, Resource)                                     \\
    Principal \hspace*{-3ex} & $\rightarrow$ & \hspace*{-3ex} Role $|$ Role(Condition) $|$ IsAuthenticated                      \\
    Role \hspace*{-3ex}      & $\rightarrow$ & \hspace*{-3ex} ROLE\_ADMIN $|$ ROLE\_OPERATOR $|$ ROLE\_COMMITTEE $|$ ROLE\_USER \\
    Condition \hspace*{-3ex} & $\rightarrow$ & \hspace*{-3ex} string$*$                                                         \\
    Action \hspace*{-3ex}    & $\rightarrow$ & \hspace*{-3ex} string$*$                                                         \\
    Resource \hspace*{-3ex}  & $\rightarrow$ & \hspace*{-3ex} string$*$                                                         \\
  \end{tabular}
  \caption{Simplified abstract syntax for our designed policy language}
  \label{fig:dsl}
\end{figure}

We define our policy language in a simplified abstract syntax.
%
We take inspiration from the simplified abstract
syntax~\cite{Backes+etal:2018:policy} defined for AWS and shows the abstract
syntax for our designed policy language in \fref{fig:dsl}.
%
In this syntax, $*$ denotes a list of valued elements.
%
A policy consists of a list of statements.
%
Each statement is a tuple that contains three elements: principal, action, and
resource.
%
The principal construct


